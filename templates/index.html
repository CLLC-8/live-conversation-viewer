<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oracle-live-portal</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0d1117;
            --chat-bg: #161b22;
            --accent-color: #58a6ff;
            --oracle-message: #2d333b;
            --user-message: #1a3b5c;
            --header-bg: #21262d;
            --text-color: #c9d1d9;
            --secondary-text: #8b949e;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        header {
            background-color: var(--header-bg);
            color: white;
            padding: 1rem;
            text-align: center;
            border-bottom: 1px solid #30363d;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .header-icon {
            margin-right: 1rem;
            font-size: 1.8rem;
            color: var(--accent-color);
        }
        
        .container {
            flex: 1;
            padding: 1rem;
            max-width: 1000px;
            margin: 0 auto;
            width: 100%;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .chat-container {
            flex: 1;
            overflow-y: auto;
            background-color: var(--chat-bg);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #30363d;
        }
        
        .message {
            margin-bottom: 1.5rem;
            display: flex;
            align-items: flex-start;
            animation: fadeIn 0.4s ease;
            width: 100%;
        }
        
        .user-message {
            justify-content: flex-end;
        }
        
        .system-message {
            justify-content: flex-start;
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            background-color: #333;
        }
        
        .user-message .message-avatar {
            margin-left: 12px;
            order: 2;
        }
        
        .system-message .message-avatar {
            margin-right: 12px;
            order: 1;
        }
        
        .message-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .message-bubble {
            max-width: calc(100% - 200px);
            padding: 0.75rem 1rem;
            border-radius: 18px;
            position: relative;
        }
        
        .user-message .message-bubble {
            background-color: var(--user-message);
            border-bottom-right-radius: 4px;
            order: 1;
        }
        
        .system-message .message-bubble {
            background-color: var(--oracle-message);
            border-bottom-left-radius: 4px;
            order: 2;
        }
        
        .info-message {
            background-color: rgba(255, 248, 225, 0.1);
            margin: 0 auto;
            font-style: italic;
            border-radius: 8px;
            text-align: center;
            padding: 0.5rem 1rem;
            width: 80%;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            margin-bottom: 0.4rem;
            color: var(--secondary-text);
        }
        
        .message-content {
            word-break: break-word;
            line-height: 1.4;
        }
        
        .status {
            padding: 0.5rem;
            text-align: center;
            color: var(--secondary-text);
            font-size: 0.9rem;
            background-color: var(--chat-bg);
            border-radius: 8px;
            border: 1px solid #30363d;
        }
        
        .connected {
            color: #43a047;
        }
        
        .disconnected {
            color: #e53935;
        }
        
        .timestamp {
            white-space: nowrap;
            font-size: 0.75rem;
            margin-left: 8px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 600px) {
            .message-bubble {
                max-width: calc(100% - 120px);
            }
        }
            /* Ajoutez ces styles à vos fichiers CSS existants */
body {
    position: relative;
    overflow-x: hidden;
}

/* Pour s'assurer que le contenu reste au premier plan par rapport à l'effet VantaJS */
.container, header {
    position: relative;
    z-index: 10;
}

/* Ajouter un effet de verre givré sur les conteneurs */
.chat-container, .admin-panel, .status {
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}

.chat-container:hover, .admin-panel:hover {
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

/* Effets visuels sur les messages */
.message {
    transition: transform 0.2s ease;
}

.message:hover {
    transform: translateY(-2px);
}

/* Animation d'apparition subtile pour les éléments */
@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.container {
    animation: fadeInUp 0.8s ease forwards;
}

/* Amélioration des boutons avec effet de halo */
button {
    box-shadow: 0 0 10px rgba(88, 166, 255, 0);
    transition: all 0.3s ease;
}

button:hover {
    box-shadow: 0 0 10px rgba(88, 166, 255, 0.5);
    transform: translateY(-2px);
}
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vanta/0.5.24/vanta.fog.min.js"></script>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="header-icon"><i class="fas fa-eye"></i></div>
            <h1>Oracle des Dimensions</h1>
        </div>
    </header>
    
    <div class="container">
        <div class="chat-container" id="chatContainer">
            <!-- Affichage de l'historique des messages -->
            {% if history %}
                {% for message in history %}
                    {% if message.type == 'info' %}
                        <div class="info-message">
                            <div class="message-content">{{ message.content }}</div>
                            <div class="timestamp">{{ message.timestamp.strftime('%d/%m/%Y %H:%M:%S') }}</div>
                        </div>
                    {% else %}
                        <div class="message {{ message.type }}-message">
                            <div class="message-bubble">
                                <div class="message-header">
                                    <span>{% if message.type == 'system' %}L'Oracle{% else %}Voyageur{% endif %}</span>
                                    <span class="timestamp">{{ message.timestamp.strftime('%d/%m/%Y %H:%M:%S') }}</span>
                                </div>
                                <div class="message-content">{{ message.content }}</div>
                            </div>
                            <div class="message-avatar">
                                <img src="{% if message.type == 'system' %}/static/oracle_avatar.png{% else %}/static/voyageur_avatar.png{% endif %}" alt="{% if message.type == 'system' %}Oracle{% else %}Voyageur{% endif %}">
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
            <!-- Les nouveaux messages seront ajoutés ici -->
        </div>
        
        <div class="status" id="connectionStatus">
            <span class="disconnected">
                <i class="fas fa-circle"></i> Connexion aux dimensions interrompue
            </span>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.min.js"></script>
    <script>
        // Connexion à Socket.IO
        const socket = io();
        const chatContainer = document.getElementById('chatContainer');
        const connectionStatus = document.getElementById('connectionStatus');
        
        // Fonction pour formater la date
        function formatDate(date) {
            const now = new Date();
            const messageDate = new Date(date);
            
            // Format: JJ/MM/YYYY HH:MM:SS
            const day = messageDate.getDate().toString().padStart(2, '0');
            const month = (messageDate.getMonth() + 1).toString().padStart(2, '0');
            const year = messageDate.getFullYear();
            const hours = messageDate.getHours().toString().padStart(2, '0');
            const minutes = messageDate.getMinutes().toString().padStart(2, '0');
            const seconds = messageDate.getSeconds().toString().padStart(2, '0');
            
            return `${day}/${month}/${year} ${hours}:${minutes}:${seconds}`;
        }
        
        // Gestion de la connexion
        socket.on('connect', () => {
            connectionStatus.innerHTML = '<span class="connected"><i class="fas fa-circle"></i> Canal dimensionnel ouvert</span>';
        });
        
        socket.on('disconnect', () => {
            connectionStatus.innerHTML = '<span class="disconnected"><i class="fas fa-circle"></i> Connexion aux dimensions interrompue</span>';
        });
        
        // Réception des nouveaux messages
        socket.on('new_message', (data) => {
            // Créer un élément de message
            const messageDiv = document.createElement('div');
            
            // Pour les messages de type info
            if (data.type === 'info') {
                messageDiv.className = 'info-message';
                messageDiv.innerHTML = `
                    <div class="message-content">${data.content}</div>
                    <div class="timestamp">${formatDate(new Date())}</div>
                `;
            } else {
                // Ajouter les classes appropriées selon le type de message
                messageDiv.className = `message ${data.type}-message`;
                
                // Créer le contenu du message
                messageDiv.innerHTML = `
                    <div class="message-bubble">
                        <div class="message-header">
                            <span>${data.type === 'user' ? 'Voyageur' : (data.type === 'system' ? 'L\'Oracle' : 'Info')}</span>
                            <span class="timestamp">${formatDate(new Date())}</span>
                        </div>
                        <div class="message-content">${data.content}</div>
                    </div>
                    <div class="message-avatar">
                        <img src="${data.type === 'system' ? '/static/oracle_avatar.png' : '/static/voyageur_avatar.png'}" alt="${data.type === 'system' ? 'Oracle' : 'Voyageur'}">
                    </div>
                `;
            }
            
            // Ajouter le message au conteneur de discussion
            chatContainer.appendChild(messageDiv);
            
            // Faire défiler vers le bas pour voir le nouveau message
            chatContainer.scrollTop = chatContainer.scrollHeight;
        });

        // Faire défiler vers le bas au chargement initial
        window.onload = function() {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        };
    </script>
        <script>
  // Configuration de l'animation de fond Vanta Fog
  VANTA.FOG({
    el: "body",
    mouseControls: true,
    touchControls: true,
    gyroControls: false,
    minHeight: 200.00,
    minWidth: 200.00,
    highlightColor: 0xff00e0, // Couleur indigo profond
    midtoneColor: 0x87ff,   // Couleur pourpre
    lowlightColor: 0x000000,  // Noir pour la profondeur
    baseColor: 0x0,      // Bleu-noir comme base
    blurFactor: 0.63,         // Niveau de flou
    speed: 2.70,              // Vitesse d'animation
    zoom: 0.60                // Niveau de zoom

  });
  // Ajoutez cette fonction aux deux fichiers, juste après l'initialisation de VANTA.FOG
// Détection de performances
function checkPerformance() {
    // Vérifier si l'appareil a probablement des performances limitées
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    const isOldBrowser = !window.WebGLRenderingContext;
    
    if (isMobile || isOldBrowser || window.innerWidth < 768) {
        // Désactiver l'animation pour les appareils à faibles performances
        if (window.vantaEffect) {
            window.vantaEffect.destroy();
        }
        document.body.style.background = "linear-gradient(135deg, #0d1117 0%, #161b22 100%)";
    }
}

// Vérifier les performances au chargement et au redimensionnement
window.addEventListener('load', checkPerformance);
window.addEventListener('resize', checkPerformance);
  // Assurez-vous que le contenu reste lisible en ajoutant un fond semi-transparent aux éléments clés
  document.addEventListener('DOMContentLoaded', function() {
    const chatContainer = document.querySelector('.chat-container');
    const statusElement = document.querySelector('.status');
    
    // Ajouter une légère opacité au conteneur de chat pour améliorer la lisibilité
    if (chatContainer) {
      chatContainer.style.backgroundColor = 'rgba(22, 27, 34, 0.7)';
    }
    
    if (statusElement) {
      statusElement.style.backgroundColor = 'rgba(22, 27, 34, 0.7)';
    }
  });
</script>
</body>
</html>
